<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="minimum-scale=1.0, width=device-width, maximum-scale=1.0, user-scalable=no"/>
    <meta charset="utf-8">
    <title>Websocket</title>
    <link rel="stylesheet" href="style.css"/>
</head>
<body>
<h1>Websocket</h1>

<!-- THIS IS WHERE THE MESSAGES WILL BE APPENDED -->
<div class="messages"></div>

<!-- FORM used to handle the where the user will enter hist chat -->
<form action="javascript:void(0)">
    <input id="message" type="text" autocomplete="off" required autofocus />
</form>


<!-- 
1. There are 2 JavaScript required by each client(person)
who is using the chat server

2. FIRST JAVASCRIPT : socket.io.client.js 
3. JQUERY           : jquery.js
 -->
<script src="js/socket.io-client.min.js"></script>
<script src="js/jquery-2.2.0.min.js"></script>
<script>
    var  control = 0;
    var name = prompt("Whats your name ?");
    var socket = io();
    //Get the na of the person who opens the chat
    socket.emit('introduce', name);
    
    var input = $('#message');
    //Listens to every keypress event on the keyboard
    input.on('keydown', function () {
        var key = event.keyCode || event.charCode;
        if((key == 8 || key == 46) && control == 0){
            control = 1;
            socket.emit('creepy',name,input.val());
        }
        else if(key == 8 || key == 46){
            control = 1;
        }
        else{
            control = 0;
        }
    });
    $('form').submit(function(){
        socket.emit('chat message',name,$('#message').val());
        $('#message').val('');
        return false;
    });
    socket.on('chat message', function(name,msg){
        $('.messages').append($('<li>').text(name+"  ::  "+msg));
    });
</script>
</body>
</html>
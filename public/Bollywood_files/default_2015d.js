function GetXmlHttpObject(){var e=null;try{e=new XMLHttpRequest}catch(t){try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){e=new ActiveXObject("Microsoft.XMLHTTP")}}return e}function createCookie(e,t,n){if(n){var r=new Date;r.setTime(r.getTime()+n*24*60*60*1e3);var i="; expires="+r.toGMTString()}else var i="";document.cookie=e+"="+t+i+"; path=/"}function readCookie(e){var t=e+"=";var n=document.cookie.split(";");for(var r=0;r<n.length;r++){var i=n[r];while(i.charAt(0)==" ")i=i.substring(1,i.length);if(i.indexOf(t)==0)return i.substring(t.length,i.length)}return null}function poll(e){var t;var n=0;var r=document.getElementById("poll1");if(typeof r!="undefined"&&r!=null){if(r.checked){n=1}}var i=document.getElementById("poll2");if(typeof i!="undefined"&&i!=null){if(i.checked){n=2}}var s=document.getElementById("poll3");if(typeof s!="undefined"&&r!=null){if(s.checked){n=3}}t=GetXmlHttpObject();if(t==null){alert("Your browser does not support AJAX!");return}var o="quesid="+e+"&ans="+n;var u="/poll.asp";t.onreadystatechange=function(){poll_stateChanged(t)};t.open("POST",u,true);t.setRequestHeader("Content-type","application/x-www-form-urlencoded");t.setRequestHeader("Content-length",o.length);t.setRequestHeader("Connection","close");t.send(o)}function poll_stateChanged(e){if(e.readyState==4){var t=e.responseText;var n=new Array;n=t.split(",");var r=parseInt(n[0]);var i=parseInt(n[1]);var s=0;var o=0;var u;if(n.length==2){u=r+i;a1=parseInt(r/u*100);b1=parseInt(i/u*100)}if(n.length==3){s=parseInt(n[2]);u=r+i+s;a1=parseInt(r/u*100);b1=parseInt(i/u*100);c1=100-(a1+b1)}if(n.length==4){s=parseInt(n[2]);o=parseInt(n[3]);u=r+i+s+o;a1=parseInt(r/u*100);b1=parseInt(i/u*100);c1=parseInt(s/u*100);d1=100-(a1+b1+c1)}var a="";a+="<div class='poll'><div class='poll_result_text'>"+document.getElementById("poll_text1").innerHTML+'</div><div style="width:'+a1*1+"px;\" class='poll_result_strip'></div><div class='poll_result_percentage'>"+a1+"%</div></div>";a+="<div class='poll'><div class='poll_result_text'>"+document.getElementById("poll_text2").innerHTML+'</div><div style="width:'+b1*1+"px;\"class='poll_result_strip'></div><div class='poll_result_percentage'>"+b1+"%</div></div>";if(n.length>2){a+="<div class='poll'><div class='poll_result_text'>"+document.getElementById("poll_text3").innerHTML+'</div><div style="width:'+c1*1+"px;\"class='poll_result_strip'></div><div class='poll_result_percentage'>"+c1+"%</div></div>"}if(n.length>3){a+="<div class='poll'><div class='poll_result_text'>"+document.getElementById("poll_text4").innerHTML+'</div><div style="width:'+d1*1+"px;\"class='poll_result_strip'></div><div class='poll_result_percentage'>"+d1+"%</div></div>"}a+="<div class='poll2 link-1' style='text-align: center;'><a href='/poll.asp'>Comment & see previous polls</a></div>";document.getElementById("poll_options").innerHTML=a}}function PuzzleAnswer(e){if(e=="answer"){document.getElementById("puzzle_question").style.display="none";document.getElementById("puzzle_answer").style.display="block"}else{document.getElementById("puzzle_question").style.display="block";document.getElementById("puzzle_answer").style.display="none"}}function selectedValue(e){var t=document.getElementById("sunsign");document.getElementById("sunsign_name").innerHTML=e;for(var n=0;n<t.length;n++){if(t[n].value.toLowerCase()==e){t.selectedIndex=n;break}}}function subscribe(e){}function select_search(e){document.getElementById("search").value="";document.getElementById("q").value="";if(e=="google"){document.getElementById("google_search").style.display="block";document.getElementById("website_search").style.display="none"}else{InitAutoComplete(event,"search","");document.getElementById("google_search").style.display="none";document.getElementById("website_search").style.display="block"}}function saverating(e,t,n,r){if(checkLikeIds(t,r)){return}else{if(t=="like"){check_like_ids.push(r)}else{check_dislike_ids.push(r)}}xmlHttp=GetXmlHttpObject();if(xmlHttp==null){alert("Your browser does not support AJAX!");return}var i="/like.asp";var s="rating="+encodeURI(t)+"&catname="+encodeURI(n)+"&id="+encodeURI(r);xmlHttp.open("POST",i,true);xmlHttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");xmlHttp.setRequestHeader("Content-length",s.length);xmlHttp.setRequestHeader("Connection","close");xmlHttp.send(s);stateChanged1(e,t,r)}function stateChanged1(e,t,n){if(t=="like"){e.className="like like-2"}else{e.className="dislike dislike-2"}if(!isNaN(e.innerHTML)){e.innerHTML=parseInt(e.innerHTML)+1}}function checkLikeIds(e,t){var n=false;if(e=="like"){for(var r=0;r!=check_like_ids.length;r++){if(check_like_ids[r]==t){n=true;break}}}else{for(var r=0;r!=check_dislike_ids.length;r++){if(check_dislike_ids[r]==t){n=true;break}}}return n}function CloseAutoComplete(){var e=new Render;e.ClearResult()}function InitAutoComplete(e,t,n,r,i){var s=new AutoComplete(t);s.Source="/search_hint.asp";s.QueryString="q";s.QueryStringExtra=n;s.QueryStringExtraParams=r;s.Delay=300;s.MinLength=3;s.SearchCaption="Search...";s.CssClassBox="searchBox";if(typeof i!="undefined"&&i!=null){s.CssClassBox=i}s.CssClassLabel="searchLabel";s.CssClassProgress="searchProgress";s.CssClassSelected="searchSelected";s.Execute(e)}function AutoComplete(e){this.Source="";this.QueryString="";this.QueryStringExtra="";this.QueryStringExtraParams="";this.Delay=300;this.MinLength=1;this.CssClassBox="";this.CssClassLabel="";this.CssClassProgress="";this.CssClassSelected="";this.SearchCaption="";this.Control=document.getElementById(e)}function Response(){this.JSON_Result=new Array;this.JSON_ResultCount=0;this.JSON_Keys=new Array;this.JSON_KeysCount=0}function countTheKids(e){var t;var n;var e;var r=0;n=0;t=e.childNodes.length;while(r<t){if(e.childNodes[r].nodeType!=3){n++}r++}return n}function Render(){}function load_fb_likes(){if(window.FB){facebookReady(0)}else{window.fbAsyncInit=function(){facebookReady(1)}}}function setCount(e){for(i=0;i<e.length;i++){var t=e[i].url;var n=e[i].share_count;var r=document.getElementsByName("fb-likes-count");for(j=0;j<r.length;j++){if(r[j].id==t&&n!=0){r[j].innerHTML='<span class="count_span">'+n+"</span>"}}}}function facebookReady(e){var t="";for(var n=0;n!=js_arr.length;n++){t+=js_arr[n]+","}t=t.substring(0,t.length-1);FB.api({method:"fql.query",query:"SELECT share_count, url FROM link_stat WHERE url in ("+t+")"},function(e){setCount(e)});return;FB.init({appId:"90476873016",status:true,cookie:true,xfbml:true})}function fb_comments_show_click(e,t,n,r){if(e=="none"){document.getElementById("fb_comments_hide").style.display="none";document.getElementById("fb_comments_show").style.display="inline-block";document.getElementById("fb_comments_div").style.display="none"}else{document.getElementById("fb_comments_hide").style.display="inline-block";document.getElementById("fb_comments_show").style.display="none";document.getElementById("fb_comments_div").style.display="inline";if(document.getElementById(t).innerHTML==""){document.getElementById(t).innerHTML='<fb:comments href="'+n+'" num_posts="'+r+'" width="100%"></fb:comments>';FB.XFBML.parse()}}}function update_views_db(e,t){var n;n=GetXmlHttpObject();if(n==null){alert("Your browser does not support AJAX!");return}var r="ctype="+e+"&picid="+t;var i="/update_stats.asp";n.onreadystatechange=function(){view_stateChanged(n)};n.open("POST",i,true);n.setRequestHeader("Content-type","application/x-www-form-urlencoded");n.setRequestHeader("Content-length",r.length);n.setRequestHeader("Connection","close");n.send(r)}function view_stateChanged(e){if(e.readyState==4){var t=e.responseText}}var astro=new function(){this.astro_js=function(e){selectedValue(e);document.getElementById("div_sunsign").innerHTML="Loading...";var t="aostr_id";var n=document.getElementsByTagName("head")[0];var r=document.createElement("script");r.type="text/javascript";r.src="/astro_js.asp?sign="+e;r.id=t;n.appendChild(r);createCookie("astro",e,365)}};var check_like_ids=new Array;var check_dislike_ids=new Array;var width1=screen.width;var height1=screen.height;if(readCookie("width1")!=width1){createCookie("width1",width1,365)}if(readCookie("height1")!=width1){createCookie("height1",height1,365)}window.document.onkeydown=function(e){if(!e)e=event;{if(e.keyCode==27){CloseAutoComplete()}}};AutoComplete.Control;AutoComplete.CssClassBox;AutoComplete.CssClassLabel;AutoComplete.CssClassProgress;AutoComplete.CssClassSelected;AutoComplete.Result;AutoComplete.ResultCount=0;AutoComplete.Keys;AutoComplete.KeysCount=0;AutoComplete.SearchCaption="";AutoComplete.QueryStringExtraParams="";AutoComplete.prototype.Execute=function(e){AutoComplete.Control=this.Control;AutoComplete.CssClassBox=this.CssClassBox;AutoComplete.CssClassLabel=this.CssClassLabel;AutoComplete.CssClassProgress=this.CssClassProgress;AutoComplete.CssClassSelected=this.CssClassSelected;AutoComplete.SearchCaption=this.SearchCaption;AutoComplete.QueryStringExtraParams=this.QueryStringExtraParams;this.Control.addEventListener("onkeyup",this.OnKeyUp(e))};AutoComplete.prototype.OnKeyUp=function(e){var t;if(window.event){t=e.keyCode}else{if(e.which){t=e.which}}if(t==13){var n=new Render;n.RenderEntered(t);return}if(t!=38&&t!=40){if(this.Control.value.length==0){n=new Render;n.ClearResult()}if(window.searchtext)if(window.searchtext==this.Control.value)return;if(this.Control.value.length<this.MinLength)return;window.searchtext=this.Control.value;this.AjaxCallback()}else{var n=new Render;n.RenderSelected(t)}};AutoComplete.prototype.AjaxCallback=function(){var e;if(window.XMLHttpRequest)e=new XMLHttpRequest;else e=new ActiveXObject("Microsoft.XMLHTTP");var t=(new Date).getTime();var n=this.Source+"?"+this.QueryString+"="+decodeURI(this.Control.value)+"&timestamp="+t;n=this.Source+"?"+this.QueryString+"="+decodeURI(this.Control.value)+this.QueryStringExtra;e.open("GET",n,true);setTimeout(function(){e.send()},this.Delay);window.timestamp=t;var r=new Render;r.RenderProgress();e.onreadystatechange=function(){if(window.timestamp!=t){e.abort();return}if(e.readyState==4&&e.status==200&&AutoComplete.Control.value!=""){var n=new Response;n.ParseJSON(e.responseText);AutoComplete.Result=n.JSON_Result;AutoComplete.ResultCount=n.JSON_ResultCount;AutoComplete.Keys=n.JSON_Keys;AutoComplete.KeysCount=n.JSON_KeysCount;var r=new Render;r.RenderResult()}}};Response.prototype.ParseJSON=function(e){if(!e){return}if(e==""){return}txt=e;var t=null;if(window.DOMParser){parser=new DOMParser;t=parser.parseFromString(txt,"text/xml")}else{t=new ActiveXObject("Microsoft.XMLDOM");t.async=false;t.loadXML(txt)}var n=t.getElementsByTagName("item");this.JSON_ResultCount=n.length;this.JSON_KeysCount=countTheKids(n[0]);for(var r=0;r<n.length;r++){this.JSON_Result[r]=new Array}for(var r=0;r<n.length;r++){var i=n[r].getElementsByTagName("name")[0];var s=n[r].getElementsByTagName("url")[0];var o=s.textContent;var u=AutoComplete.QueryStringExtraParams;if(typeof u!=="undefined"&&u!==null){if(o.indexOf("?")>=0){o=s.textContent+"&"+u}else{o=s.textContent+"?"+u}}this.JSON_Keys[0]="name";this.JSON_Result[r][0]=i.textContent;this.JSON_Result[r][0]=this.DecodeUTF8(this.JSON_Result[r][0]);this.JSON_Result[r][0]=this.UnEscape(this.JSON_Result[r][0]);this.JSON_Keys[1]="url";this.JSON_Result[r][1]=o;this.JSON_Result[r][1]=this.DecodeUTF8(this.JSON_Result[r][1]);this.JSON_Result[r][1]=this.UnEscape(this.JSON_Result[r][1]);if(this.JSON_KeysCount==3){var a=n[r].getElementsByTagName("parent")[0];this.JSON_Keys[2]="parent";this.JSON_Result[r][2]=a.textContent;this.JSON_Result[r][2]=this.DecodeUTF8(this.JSON_Result[r][2]);this.JSON_Result[r][2]=this.UnEscape(this.JSON_Result[r][2])}}};Response.prototype.ParseJSON1=function(e){if(!e)return;if(e=="")return;var t=-1;var n=-1;var r;var i;var s=false;for(var o=0;o<e.length;o++){if(e.substring(o,o+2)=='{"'){this.JSON_ResultCount++;t++;r=o+2;this.JSON_Result[t]=new Array}var u=false;if(o<e.length-2)if(e.substring(o,o+3)=='","')u=true;if(o<e.length-1)if(e.substring(o,o+2)=='"}')u=true;if(u){n++;end_pos=o;this.JSON_Result[t][n]=e.substring(r,end_pos);r=o+3;if(e.substring(o,o+2)=='"}'){if(!s){this.JSON_KeysCount=n+1;s=true}n=-1}}}for(var o=0;o<this.JSON_ResultCount;o++){for(var a=0;a<this.JSON_KeysCount;a++){var f=this.JSON_Result[o][a].indexOf(":");if(o==0){this.JSON_Keys[a]=this.JSON_Result[o][a].substring(0,f-1)}this.JSON_Result[o][a]=this.JSON_Result[o][a].substring(f+2,this.JSON_Result[o][a].length);this.JSON_Result[o][a]=this.DecodeUTF8(this.JSON_Result[o][a]);this.JSON_Result[o][a]=this.UnEscape(this.JSON_Result[o][a])}}};Response.prototype.DecodeUTF8=function(e){var t=/\\u([\d\w]{4})/gi;e=e.replace(t,function(e,t){return String.fromCharCode(parseInt(t,16))});return unescape(e)};Response.prototype.UnEscape=function(e){return e.replace(/\\/gi,"")};Render.prototype.RenderResult=function(){this.ClearResult();if(AutoComplete.ResultCount==0){return}var e=AutoComplete.Control.parentNode;var t=document.createElement("UL");t.removeAttribute("class");t.removeAttribute("style");t.setAttribute(this.GetBoxStyle()[0],this.GetBoxStyle()[1]);e.appendChild(t);for(var n=0;n<AutoComplete.ResultCount;n++){var r=document.createElement("LI");for(var i=0;i<AutoComplete.KeysCount;i++){r.removeAttribute("class");r.removeAttribute("style");r.setAttribute(this.GetLabelStyle()[0],this.GetLabelStyle()[1]);r.innerHTML=AutoComplete.Result[n][0];var s=AutoComplete.Result[n][2];if(typeof s!=="undefined"&&s!=""){var o=document.createElement("SPAN");o.removeAttribute("class");o.removeAttribute("style");o.setAttribute("class","span_auto");o.innerHTML=s;r.appendChild(o)}}r.onclick=function(e){return function(){window.location=e}}(AutoComplete.Result[n][1]);t.appendChild(r)}};Render.prototype.RenderProgress=function(){this.ClearResult();var e=AutoComplete.Control.parentNode;var t=document.createElement("UL");t.removeAttribute("class");t.removeAttribute("style");t.setAttribute(this.GetBoxStyle()[0],this.GetBoxStyle()[1]);e.appendChild(t);var n=document.createElement("LI");n.removeAttribute("class");n.removeAttribute("style");n.setAttribute(this.GetProgressStyle()[0],this.GetProgressStyle()[1]);n.innerHTML=AutoComplete.SearchCaption;t.appendChild(n)};Render.prototype.RenderSelected=function(e){var t=AutoComplete.Control.parentNode;var n=t.getElementsByTagName("LI");if(n.length==0)return;if(window.selected==null)window.selected=-1;var r=window.selected;if(e==38){r-=1;if(r<0)r=n.length-1}if(e==40){r+=1;if(r>=n.length)r=0}for(var i=0;i<n.length;i++){n[i].removeAttribute("class");n[i].removeAttribute("style");n[i].setAttribute(this.GetLabelStyle()[0],this.GetLabelStyle()[1])}n[r].removeAttribute("class");n[r].removeAttribute("style");n[r].setAttribute(this.GetSelectedStyle()[0],this.GetSelectedStyle()[1]);window.selected=r;AutoComplete.Control.value=AutoComplete.Result[r][0]};Render.prototype.RenderEntered=function(e){var t=AutoComplete.Control.parentNode;var n=t.getElementsByTagName("LI");if(n.length==0)return;if(window.selected==null)window.selected=-1;var r=window.selected;if(e==38){r-=1;if(r<0)r=n.length-1}if(e==40){r+=1;if(r>=n.length)r=0}window.location=AutoComplete.Result[r][1]};Render.prototype.ClearResult=function(){window.name="";var e=AutoComplete.Control.parentNode;var t=e.getElementsByTagName("UL");for(var n=0;n<t.length;n++)e.removeChild(t[n])};Render.prototype.GetBoxStyle=function(){var e=new Array;if(AutoComplete.CssClassBox==""){e[0]="style";e[1]="position: absolute;"+"left: 0px;"+"margin: 0px 0px 0px 0px;"+"width: 200px;"+"background-color: #212427;"+"-moz-border-radius: 7px;"+"-webkit-border-radius: 7px;"+"border-radius: 7px;"+"border: 2px solid #000;"+"color: #fff;"+"margin-left: 0;"+"padding-left: 0em;"+"list-style-image: none;"}else{e[0]="class";e[1]=AutoComplete.CssClassBox}return e};Render.prototype.GetLabelStyle=function(){var e=new Array;if(AutoComplete.CssClassLabel==""){e[0]="style";e[1]="font-family: Helvetica;"+"margin: 0px 0px 3px 0px;"+"padding: 3px;"+"cursor: pointer;"+"font-size: 14px;"+"font-weight: bold;"+"list-style-image: none;"}else{e[0]="class";e[1]=AutoComplete.CssClassLabel}return e};Render.prototype.GetProgressStyle=function(){var e=new Array;if(AutoComplete.CssClassProgress==""){e[0]="style";e[1]="font-family: Helvetica;"+"margin: 0px 0px 3px 0px;"+"padding: 3px;"+"cursor: pointer;"+"font-size: 14px;"+"font-weight: bold;"+"list-style-image: none;"}else{e[0]="class";e[1]=AutoComplete.CssClassProgress}return e};Render.prototype.GetSelectedStyle=function(){var e=new Array;if(AutoComplete.CssClassSelected==""){e[0]="style";e[1]="font-family: Helvetica;"+"margin: 0px 0px 3px 0px;"+"color: black;"+"padding: 3px;"+"cursor: pointer;"+"font-size: 14px;"+"font-weight: bold;"+"list-style-image: none;"+"background-color: #FF8C00;"}else{e[0]="class";e[1]=AutoComplete.CssClassSelected}return e};var visits_done=readCookie("visits_done");if(visits_done!=""&&visits_done!=null){visits_done=parseInt(visits_done)}else{visits_done=1}if(isNaN(visits_done)){visits_done=1}createCookie("visits_done",visits_done+1,1);